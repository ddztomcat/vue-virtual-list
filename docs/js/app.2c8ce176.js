(function(t){function e(e){for(var n,o,a=e[0],h=e[1],u=e[2],l=0,d=[];l<a.length;l++)o=a[l],s[o]&&d.push(s[o][0]),s[o]=0;for(n in h)Object.prototype.hasOwnProperty.call(h,n)&&(t[n]=h[n]);c&&c(e);while(d.length)d.shift()();return r.push.apply(r,u||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],n=!0,a=1;a<i.length;a++){var h=i[a];0!==s[h]&&(n=!1)}n&&(r.splice(e--,1),t=o(o.s=i[0]))}return t}var n={},s={app:0},r=[];function o(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=n,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],h=a.push.bind(a);a.push=e,a=a.slice();for(var u=0;u<a.length;u++)e(a[u]);var c=h;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";var n=i("64a9"),s=i.n(n);s.a},"56d7":function(t,e,i){"use strict";i.r(e);i("cadf"),i("551c"),i("f751"),i("097d");var n=i("2b0e"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("p",[t._v("可变高度")]),i("virtual-list",{attrs:{dynamic:!0,"min-size":30,total:t.items.length,height:"200px"},on:{"reach-bottom":t.handleReachBottomDynamic}},t._l(t.items,function(e,n){return i("virtual-list-item",{key:e.id,staticClass:"item",attrs:{index:n}},[t._v("\n      "+t._s(e.id+" "+e.text)+"\n    ")])}),1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showLoading,expression:"showLoading"}],staticClass:"loading"},[i("van-loading",{attrs:{type:"spinner"}})],1),i("p",[t._v("固定高度")]),i("virtual-list",{attrs:{"min-size":30,total:t.items1.length,height:"300px"},on:{"reach-bottom":t.handleReachBottom}},t._l(t.items1,function(e){return i("div",{key:e.id,staticClass:"item"},[t._v(t._s(e.id))])}),0),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showLoading1,expression:"showLoading1"}],staticClass:"loading"},[i("van-loading",{attrs:{type:"spinner"}})],1)],1)},r=[],o=i("bd86"),a=(i("7f7f"),i("c5f6"),i("b970"));function h(){for(var t="是的活佛阿旺回复哦啊我护法还无法八王坟",e="",i=~~(30*Math.random()),n=0;n<i;n++)e+=t;return e}i("157a");var u=i("5118"),c=function(){for(var t=[],e=0;e<1e4;e++)t.push({id:e,text:h()});return t}(),l={name:"app",data:function(){return{items:c.slice(0,50),items1:c.slice(0,1e3),id:50,id1:1e3,showLoading:!1,showLoading1:!1}},methods:{handleClick:function(){var t=Number(Math.ceil(100*Math.random()));this.items=c.slice(0,t)},handleReachBottomDynamic:function(t){var e=this;this.showLoading=!0,this.items=this.items.concat(c.slice(this.id,this.id+10)),this.id+=10,Object(u["setTimeout"])(function(){return e.showLoading=!1},300)},handleReachBottom:function(t){var e=this;this.showLoading1=!0,this.items1=this.items1.concat(c.slice(this.id1,this.id1+10)),this.id1+=10,Object(u["setTimeout"])(function(){return e.showLoading1=!1},300)}},components:Object(o["a"])({},a["a"].name,a["a"])},d=l,p=(i("034f"),i("2877")),_=Object(p["a"])(d,s,r,!1,null,null,null),m=_.exports,f=i("0a0d"),g=i.n(f),v={name:"virtual-list",install:function(t){t.component(this.name,this)},props:{size:Number,keep:Number,remUnit:{type:Number,default:0},throttle:{type:Number,default:200},cache:{type:Number,default:10}},created:function(){this.__base={currentStart:0,currentEnd:this.keep+this.cache-1,paddingTop:0,paddingBottom:0,total:0,realHeight:0},this.__index=0},methods:{getRealRenderVNodes:function(){for(var t=[],e=this.__base.currentStart;e<=this.__base.currentEnd;e++)t.push(this.$slots.default[e]);return t},recalculateBase:function(){this.__base.total||(this.__base.total=this.$slots.default.length),this.__base.realHeight||(this.__base.realHeight=this.__base.total*this.size),this.__base.currentStart=this.__index,this.__base.currentEnd=this.__index+this.keep+this.cache-1,this.__base.paddingTop=this.__index*this.size,this.__base.paddingBottom=this.__base.realHeight-this.size*(this.keep+this.cache)-this.__base.paddingTop},scroll:function(t){var e=t.target.scrollTop,i=Math.floor(e/this.size);this.__index=i,(this.__index+this.keep>=this.__base.currentEnd||this.__index<=this.__base.currentStart)&&this.$forceUpdate()},getThrottle:function(t){var e=this,i=g()(),n=null;return function(s){var r=g()();r-i>=e.throttle?(clearTimeout(n),t.call(e,s),i=r):(clearTimeout(n),n=setTimeout(function(){t.call(e,s)},e.throttle))}},pxOrRem:function(t){return this.remUnit>0?(t/this.remUnit).toFixed(8)+"rem":t+"px"}},updated:function(){},mounted:function(){},render:function(t){this.recalculateBase();var e=this.getRealRenderVNodes(),i=this.__base;return t("div",{style:{height:this.pxOrRem(this.size*this.keep),overflow:"auto"},on:{scroll:this.throttle?this.getThrottle(this.scroll):this.scroll}},[t("div",{style:{paddingTop:this.pxOrRem(i.paddingTop),paddingBottom:this.pxOrRem(i.paddingBottom)}},e)])}},b={name:"virtual-list",install:function(t){t.component(this.name,this)},provide:function(){return{parentRef:this}},props:{minSize:Number,total:Number,height:[String,Number],bottomBlur:{type:Number,default:30},keep:{type:Number,default:10},throttle:{type:Number,default:20},dynamic:{type:Boolean,default:!1},cache:{type:Number,default:10}},created:function(){var t=this.getViewHeight();if(this.__base={currentStart:0,currentEnd:this.keep+this.cache-1,paddingTop:0,paddingBottom:0,total:this.total,realHeight:0,viewHeight:t},this.__lastScrollTop=0,this.__index=0,this.__viewPxHeight=0,this.__itemsSize=new Array(this.__base.total),this.dynamic)this.$on("child-update",this.childUpdate);else for(var e=0;e<this.total;e++)this.__itemsSize[e]=this.minSize;this.judgeReachBottom=this.getDebounce(this.judgeReachBottom,1e3)},methods:{childUpdate:function(t,e){this.__itemsSize[t]=e.height},getRealRenderVNodes:function(){for(var t=[],e=this.__base.currentStart;e<=this.__base.currentEnd&&e<this.total;e++)t.push(this.$slots.default[e]);return t},getViewHeight:function(){var t="";return t=isNaN(this.height)?this.height?this.height:this.keep*this.minSize+"px":this.height+"px",t},recalculateBase:function(){this.__base.total=this.total,this.__base.currentStart=this.__index,this.__base.currentEnd=this.__index+this.keep+this.cache-1,this.__base.viewHeight=this.getViewHeight();for(var t=0,e=0,i=0,n=0;n<this.__base.total;n++)e+=this.__itemsSize[n]?this.__itemsSize[n]:this.minSize,n<this.__index?t+=this.__itemsSize[n]?this.__itemsSize[n]:this.minSize:n>=this.__index&&n<=this.__base.currentEnd&&(i+=this.__itemsSize[n]?this.__itemsSize[n]:this.minSize);this.__base.realHeight=e,this.__base.paddingTop=t,this.__base.paddingBottom=e-i-t},getIndex:function(t){for(var e=0,i=0;i<this.__base.total;i++)if(e+=this.__itemsSize[i]?this.__itemsSize[i]:this.minSize,e>=t)return i;return this.__base.total-1},judgeReachBottom:function(t,e,i){for(var n=0,s=0;s<this.total;s++)n+=this.__itemsSize[s]?this.__itemsSize[s]:this.minSize;e+this.__viewPxHeight+this.bottomBlur>=n&&e>t&&this.$emit("reach-bottom",i)},scroll:function(t){var e=t.target.scrollTop,i=this.getIndex(e);this.__index=i,this.$emit("scroll",t),this.judgeReachBottom(this.__lastScrollTop,e,t),(this.__index+this.keep>=this.__base.currentEnd||this.__index<=this.__base.currentStart)&&this.$forceUpdate(),this.__lastScrollTop=e},getDebounce:function(t,e){var i=this,n=null;return function(){for(var s=arguments.length,r=new Array(s),o=0;o<s;o++)r[o]=arguments[o];clearTimeout(n),n=setTimeout(function(){t.call.apply(t,[i].concat(r))},e)}},getThrottle:function(t,e){var i=this,n=g()(),s=null;return function(r){var o=g()();o-n>=e?(clearTimeout(s),t.call(i,r),n=o):(clearTimeout(s),s=setTimeout(function(){t.call(i,r)},e))}},pxOrRem:function(t){return t+"px"},getBounds:function(){return this.$el.getBoundingClientRect()}},updated:function(){},mounted:function(){var t=this;this.$nextTick(function(){var e=t.getBounds();t.__viewPxHeight=e.height})},render:function(t){this.recalculateBase();var e=this.getRealRenderVNodes(),i=this.__base;return t("div",{style:{height:i.viewHeight,overflow:"auto"},on:{scroll:this.throttle?this.getThrottle(this.scroll,this.throttle):this.scroll}},[t("div",{style:{paddingTop:this.pxOrRem(i.paddingTop),paddingBottom:this.pxOrRem(i.paddingBottom)}},e)])}},x={name:"virtual-list-item",install:function(t){t.component(this.name,this)},inject:["parentRef"],props:{index:Number},methods:{getBounds:function(){return this.$el.getBoundingClientRect()}},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){var e=t.getBounds();t.parentRef.$emit("child-update",t.index,e)})},updated:function(){var t=this;this.$nextTick(function(){var e=t.getBounds();t.parentRef.$emit("child-update",t.index,e)})},render:function(t){return t("div",{ref:"item-wrap"},this.$slots.default)}},S={name:"test-parent",install:function(t){t.component(this.name,this)},data:function(){return{zent:{x:1,y:2},room:{a:1,b:2}}},render:function(t){return t("div",[this.$scopedSlots.default(this.zent),this.$scopedSlots.room(this.room)])}},w={name:"test-child",install:function(t){t.component(this.name,this)},data:function(){return{}},render:function(t){return t("div",[t("test-parent",{scopedSlots:{default:function(e){return t("span",e.x)},room:function(e){return t("span",e.b)}}})])}};n["a"].config.productionTip=!1,n["a"].use(v).use(b).use(x).use(S).use(w),new n["a"]({render:function(t){return t(m)}}).$mount("#app")},"64a9":function(t,e,i){}});
//# sourceMappingURL=app.2c8ce176.js.map